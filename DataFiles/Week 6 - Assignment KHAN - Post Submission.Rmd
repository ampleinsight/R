---
title: "Data Viz FA 2020: Week 6 Assignment"
author: "Ahmed Khan"
date: "10/10/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
setwd("/Users/ahmedkhan/Documents")

NILS = read_csv("WHO_NILS_ALL.csv")
FAO = read_csv("UNFAO_by_Year.csv")
GFSI = read_csv("GlobalFoodSecurityIndex_2019.csv")

#Long format the FAO data (prep for Tidyverse use)
FAO = FAO %>% pivot_longer(cols = starts_with("20"), names_to = "year", values_to = "values")

#Fix year format
FAO$year = as.numeric(FAO$year)

```

## Summary Narrative

This report shows some high level metrics of dietary indicators at the global level.

Figure 1 shows that, on the whole, the world has met and exceeded the minimum dietary needs of people around the globe. Further, the world continues to exceed minimum dietary needs, even through the major financial recession of 2009.

Figure 2 shows the trend by region. Of important note is that since the recession of 2009, all regions of the world have somewhat stabilized in their growth of meeting dietary needs -- except for Asia. This might be because Asia has seen tremendous economic growth over the last decade, enabling billions of people to meet dietary needs more and more. 

```{r example}
#summary(cars)
```


```{r pressure, echo=FALSE}
#Global Level
FAO_Avg_Diet_Adeq = filter(FAO, Indicator =="Average dietary energy supply adequacy" & Regions.Subregions.Countries == "WORLD")

#names(FAO)
fig_data_FAO_Diet_Adeq = tibble("Year"=as.numeric(FAO_Avg_Diet_Adeq$year), "Diet_Adequacy" = FAO_Avg_Diet_Adeq$values)

#str(fig_data_FAO_Diet_Adeq)

ggplot(fig_data_FAO_Diet_Adeq, aes(x=Year, y=Diet_Adequacy)) + 
  geom_line(color = "orange", size = 0.5) + theme_classic() +
  theme(plot.title = element_text(face="bold", color = "orange"), axis.text.x = element_text(face="bold"), axis.text.y = element_text(color = "orange")) +
#   + 
 #  +
  xlim(2000,2020) + ylim(110,120) +
  labs(x="Year",y="% of Dietary Need Met",title="Fig 1. World Food Adeqancy Rate Trends (2000-2019)", subtitle = "Percent of Overall Dietary Need Met at the Global Level", caption = "Source: UN Food and Agriculture Organization")

##Regional Level

FAO_Avg_Diet_Adeq_Reg = 
  filter(FAO, Indicator =="Average dietary energy supply adequacy" & 
          (
            Regions.Subregions.Countries == "NORTHERN AMERICA AND EUROPE"|
            Regions.Subregions.Countries == "LATIN AMERICA AND THE CARIBBEAN"|
            Regions.Subregions.Countries == "OCEANIA"|
            Regions.Subregions.Countries == "ASIA"|
            Regions.Subregions.Countries == "AFRICA"
          )
         )

fig_data_FAO_Diet_Adeq_Reg = tibble("Year"=as.numeric(FAO_Avg_Diet_Adeq_Reg$year), "Diet_Adequacy" = FAO_Avg_Diet_Adeq_Reg$values, "Region" = FAO_Avg_Diet_Adeq_Reg$Regions.Subregions.Countries)

ggplot(fig_data_FAO_Diet_Adeq_Reg, aes(x=Year, y=Diet_Adequacy, group = Region, color = Region)) + 
  geom_line() + theme_classic() +
  ##+geom_smooth(method = "loess", se = FALSE, size = 1.1)
  theme(plot.title = element_text(face="bold", color = "orange"), axis.text.x = element_text(face="bold"), legend.position="bottom")+
  xlim(2000,2020) +
  labs(x="Year",y="% of Dietary Need Met",title="Fig 2. Food Adeqancy Rate Trends by Region (2000-2019)", subtitle = "Percent of Overall Dietary Need Met at the Regional Level", caption = "Source: UN Food and Agriculture Organization") +
  scale_color_discrete(labels = function(x) str_wrap(x, width = 8))
  ##+facet_wrap (~Region, ncol = 5)


```

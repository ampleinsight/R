---
title: "Data Viz FA 2020: Week 7 Assignment"
author: "Ahmed Khan"
date: "10/17/2020"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(dplyr)
####Use read_csv instead of read.csv

#### make sure you have the file in your working directory, or use the complete file path. Use setwd() if you need to.

setwd("/Users/ahmedkhan/Documents")

NILS = read_csv("WHO_NILS_ALL.csv")
FAO = read_csv("UNFAO_by_Year.csv")
GFSI = read_csv("GlobalFoodSecurityIndex_2019.csv")
#Imports as a Tibble

#Long format the FAO data (prep for Tidyverse use)
FAO = FAO %>% pivot_longer(cols = starts_with("20"), names_to = "Year", values_to = "Value")

head(FAO)
head(NILS)
head(GFSI)

unique(FAO$Indicator)

#Filter to get countries
FAO_Pop = filter(FAO, Indicator ==  "Total population"  & IsCountry == "Y")

#Get latest value available for each country
FAO_Pop_Max = FAO_Pop %>% group_by(Regions.Subregions.Countries) %>%
  slice(which.max(Year)) %>%
  select(Region, Regions.Subregions.Countries, Value)


```

## Summary Narrative

This report shows some high level metrics of the world's population and how meeting minimum dietary needs varies by a country's economic activity.

Chart 1 is a bar plot showing the distribution of the world population by region. While this  information seems basic, it is important to know how many people live where. That information can help us understand global dynamics that underpin almost every aspect of geopolitical activity - including public health outcomes and concentration of resources by region.

Chart 2 is a ridge line plot showing how countries at different levels of economic activity have met (or failed to meet) basic dietary needs over time. As you can see, countries with low average incomes have had a tougher time in meeting dietary needs for their populations - often falling short of meeting 100% of minimal dietary energy needs. Countries with high income, on the other hand, have far exceeded meeting minimum requirements. This helps us see an oportunity where higher income countries can direct some food aid resources to lower income countries to meet basic dietary needs of people across the globe. 

```{r example}
#summary(cars)
```


```{r pressure, echo=FALSE, message=FALSE, warning = FALSE}
     
####make a bar plot
#INSTRUCTOR FEEDBACK: MAYBE A LOLLIPOP CHART WOULD BE BETTER? So Week 8 ASSIGNMENT HAS LILLIPOP PLOT INSTEAD FOR THIS SAME DATA :)
library(RColorBrewer)

ggplot(FAO_Pop_Max,aes(x=Region,y = Value, fill=Region))+
  geom_bar(stat="sum",na.rm=TRUE) +
  coord_flip()+
  theme_classic() +
  theme(legend.position = "null", axis.title.x = element_blank(), axis.title.y = element_blank(), plot.subtitle = element_text(size = 8)) +
  scale_fill_brewer(palette="Set1")+
  labs(title="Chart 1. Population Distribution by World Region (2017)", subtitle = "Population in Millions", caption="Source: UN Food and Agriculture Organization")

####make a Ridgeline plot
#INSTRUCTOR FEEDBACK: MAYBE JUST CHOOSE ONE YEAR? NOT SURE WHY COMBINED 2001-2017. DON'T NEED TO. LOVED THIS CHART!

library(ggridges)

#How about: By economy level -- how has nourishment changed over time?
  #Also can show if nourishment levels differs by economy

FAO_Econ = FAO %>% 
  filter(Indicator == "Average dietary energy supply adequacy") %>%
  filter(Subregion == "Low-income economies" | Subregion == "Lower-middle-income economies" | Subregion =="Upper-middle-income economies" | Subregion == "High-income economies")%>%
  select(Subregion, Year, Value)

#Order factor levels manually from Low to High -- so they show that way on the plot
FAO_Econ$factor =  factor(FAO_Econ$Subregion, levels = c("Low-income economies", "Lower-middle-income economies", "Upper-middle-income economies", "High-income economies"))


ggplot(FAO_Econ, aes(x = Value, y = factor, color = factor, fill = factor)) +
  geom_density_ridges ()+
  #xlim(0, 300)+
  theme_ridges()+
  theme(plot.title = element_text(hjust=1, size = 11) ,plot.subtitle = element_text(hjust=1, size = 10), axis.title=element_text(size=10, face = "bold"), axis.text.x = element_text(face="bold"), legend.position = "none", axis.title.y = element_blank(), plot.caption = element_text(size = 10)) +
  scale_fill_brewer(palette="RdYlGn")+
  scale_color_brewer(palette="RdYlGn")+
  labs(x= "% of Minimum Dietary Need Met",
       title="Chart 2. Impact of Economic Activity on Meeting Dietary Need from 2001 to 2017", subtitle = "Distribution of country scores", caption="Source: UN Food and Agriculture Organization")


```
